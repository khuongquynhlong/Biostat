---
title: "Master in Statistics and Data Science"
author: 'Student: Quynh Long Khuong'
date: "Hasselt, Belgium, 06 October 2021" #`r Sys.Date()`
output:
  html_document:
    css: style.css
    highlight: pygments
    number_sections: no
    theme: flatly
    toc: yes
    toc_depth: 2
    toc_float: yes
  word_document:
    toc: yes
    toc_depth: '2'
subtitle: 'Programming in R: Practical session 1'
institute: Hasselt University
---


```{r, echo=FALSE}
htmltools::img(src = "https://www.uhasselt.be/images/logos/2019/UHasselt-standaard.png", 
               alt = 'logo', 
               style = 'position:absolute; top:0; right:0; padding:10px; height:140px; width:auto; max-width:300px;')
```

```{r setup,include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

<div style= "height:60px; width:auto; max-width:100px;">
[![My github](images/github2.png)](https://khuongquynhlong.github.io/Biostat/)
</div>

<br>

<br>

```{r}
library(tidyverse)
library(viridis)
```

# Question 1 {.tabset .tabset-fade .tabset-pills}

## Q1.1

**1. Draw a sample of size 10 $(n=10)$ from $N(0,1)$**

```{r}
q1_1 <- rnorm(10, 0, 1)
```

## Q1.2

**2. Calculate the mean and the variance of the sample**
```{r, results='hide'}
# Mean
mean(q1_1)

# Variance
var(q1_1)
```


## Q1.3

**3. Create the following R object**

```
##     Stat      Value
## 1   mean -0.2234153
## 2    var  0.5851990
## 3 median -0.3968599
```

```{r}
Stat <- c("mean", "var", "median")
Value <- c(mean(q1_1), var(q1_1), median(q1_1))
q1_3 <- data.frame(Stat, Value)

# Print the data frame
print(q1_3)
```

# Question 2 {.tabset .tabset-fade .tabset-pills}

## Q2.1

**1. Draw a random sample of size 100 from t(3)**

```{r}
q2_1 <- rt(100, 3)
```

## Q2.2

**2. Produce the histogram of the sample**

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
# Use exact color from the question (which is #df536)
hist(q2_1, xlab = "x", main = "Histogram of x", col = "#df536b", border = "white")
```

# Question 3 {.tabset .tabset-fade .tabset-pills}

## Q3.1

**1. Define a vector x=(1,2,3,4,5,6,7,8,9,10)**

```{r}
x <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
```

## Q3.2

**2. Define a new object $y = x^2$**

```{r}
y <- x^2
```

## Q3.3

**3. Plot x versus y**

**Noted:** The figure in given example was not $y = x^2$ but $y = x^3$ (the y axis is up to 1000)

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
plot(y ~ x)
```

# Question 4 {.tabset .tabset-fade .tabset-pills}
This question uses the `cars` dataset

```{r}
# Obtain the data
data("cars")
```

## Q4.1

**1. Print the cars’ speed**

```{r}
cars$speed
```

## Q4.2
**2. Print the cars’ stopping distance**

```{r}
cars$dist
```

## Q4.3
**3. Plot the speed versus the distance**

### Basic plot

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
plot(cars$dist ~ cars$speed)
```


### ggplot2

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
cor_dist_speed <- cor.test(cars$dist, cars$speed)
cars %>% ggplot(aes(x = speed, y = dist, fill = dist, color = dist)) +
  geom_point(shape = 21, show.legend = F, size = 4, alpha = 0.7) +
  geom_smooth(fill = "gold", color = "violet", method = "lm") +
# scale_size_continuous(range = c(1, 10)) +
  scale_fill_viridis(option = "D", direction = -1) +
  annotate("text", x = 20, y = 0, 
           label = paste0("Pearson's r"," = ", 
                          round(cor_dist_speed$estimate, 2)[[1]],
                          "; p-value: ", 
                          ifelse(cor_dist_speed$p.value < 0.001, "<0.001", round(cor_dist_speed$p.value, 3))), 
           size = 5) +
  labs(
    x = "Speed",
    y = "Distance",
    title = "Relationship between stop distance and speed"
  ) +
  theme_bw() + 
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.line = element_line(size = 0.3),
        axis.text = element_text(size = 12, color = "black", hjust=1),
        axis.title = element_text(face = "bold", size = 12, color = "black"),
        plot.title = element_text(face = "bold", size = 14, color = "black", hjust = 0.5)
    )
  
```

## Q4.4

**4. What is the spearman correlation between the cars’ speed and stopping distance**

```{r}
x <- cor.test(cars$dist, cars$speed, method = "spearman")
paste0("The Spearman correlation coefficient: ", round(x$estimate[[1]], 2), 
       ", ", "with p-value: ",  ifelse(x$p.value < 0.001, "<0.001", x$p.value))
```

## Q4.5

**5. What is the minimum, maximum and median of the car speed**

```{r}
sprintf("Minimum: %.2f, Maximum: %.2f, Median: %.2f", min(cars$speed), max(cars$speed), median(cars$speed))
```


## Q4.6
**6. Define a new variable: $y=(median(distance)+3)×10$. What is the mean of y?**

_**Note**: New variable in the dataset `cars`, but it will have the same value for all rows since the question is to calculate $y=(median(distance)+3)×10$_

```{r}
cars$y = median(cars$dist + 3)*10
sprintf("Mean of y: %.2f", mean(cars$y))
```



# Question 5 {.tabset .tabset-fade .tabset-pills}

## Q5.1

**1. Produce the following data frame in R**

```
##   x     y
## 1 1   one
## 2 3 three
## 3 5  five
## 4 7 seven
```

### R base

```{r}
x <- c(1, 3, 5, 7)
y <- c("one", "three", "five", "seven")
df <- data.frame(x, y)

# Print data frame
df
```

### tidyverse tibble

```{r}
df <- tribble(
  ~x, ~y,
  1, "one",
  3, "three",
  5, "five",
  7, "seven"
)

# Print data frame
df
```


# Question 6 {.tabset .tabset-fade .tabset-pills}
This question uses the `airquality` dataset

```{r}
# Obtain the data
data("airquality")

# Check missing value
sapply(airquality, function(x){sum(is.na(x))})
```

## Q6.1

**1. How many observations there are in the data and how many variables**

```{r}
sprintf("Number of observation: %.f, and number of variable: %.f", dim(airquality)[1], dim(airquality)[2])
```


## Q6.2

**2. Define a R object (x) which contains the information about the temperature**

```{r}
x <- airquality$Temp
```

## Q6.3
**3. Define a R object (Month) which contains the information about the month**

```{r}
Month <- airquality$Month
```


## Q6.4
**4. Use the R function `boxplot()` to produce the boxplot below**

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
boxplot(x ~ as.factor(Month), xlab = "Months")
```


# Question 7 {.tabset .tabset-fade .tabset-pills}

## Q7.1

**1. Define a new R object (y) which contains the information about the Ozone level in the `airquality` data.**

```{r}
y <- airquality$Ozone
```

## Q7.2
**2. Calculate the _mean_, _median_, _minimum_, _maximum_, and _standard deviation_ of the Ozone level and produce the following table. How many observations are included in the analysis **

```{r}
w <- c("Mean", "Median", "Minimum", "Maximum", "S.D")
x <- c(mean(airquality$Ozone, na.rm = T), median(airquality$Ozone, na.rm = T),
       min(airquality$Ozone, na.rm = T), max(airquality$Ozone, na.rm = T),
       sd(airquality$Ozone, na.rm = T))

q7_2 <- data.frame(w, x)

# Print data frame
q7_2
```

```{r}
sprintf("There are %.f observations are included in the analysis", sum(!is.na(airquality$Ozone)))
```


## Q7.3

**3. Produce the graphical display below**

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
par(mfrow = c(1, 2))
hist(airquality$Ozone, main = "Histogram of Ozone level", xlab = "y")
boxplot(airquality$Ozone, main = "Boxplot of Ozone level", xlab = NULL)
```

# Question 8 {.tabset .tabset-fade .tabset-pills}

## Q8.1
**Define a new variable** 
$$ Ratio = \frac{Wind}{Temperature}$$

```{r}
airquality$Ratio = airquality$Wind/airquality$Temp
```

## Q8.2
**Plot the ratio versus the day of the month**

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
plot(airquality$Ratio ~ airquality$Day, ylab = "R", main = "ratio versus day")
```


### ggplot2

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
airquality %>% ggplot(aes(x = Day, y = Ratio, color = Ratio, fill = Ratio)) +
  geom_point(show.legend = F, shape = 21, size = 3, alpha = 0.7) +
  scale_fill_viridis(option = "C", direction = 1) +
  geom_smooth(show.legend = F, fill = "gold", color = "violet") +
  labs(
    title = "Ratio versus day"
  ) +
  theme_bw() + 
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.line = element_line(size =0.3),
        axis.text = element_text(size = 12, color = "black", hjust=1),
        axis.title = element_text(face = "bold", size = 12, color = "black"),
        plot.title = element_text(face = "bold", size = 14, color = "black", hjust = 0.5),
        legend.position = "top"
    )
```

# Question 9 {.tabset .tabset-fade .tabset-pills}

## Q9.1

**For the plot in question 8, add a horizontal line with the mean of the ratio (in <span style="color: red;">red</span> color) and chance the X and Y lables**

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
plot(airquality$Ratio ~ airquality$Day, 
     ylab = "Ratio(Wind/Temp)",
     xlab = "Day in month",
     main = "ratio versus day")
abline(h = mean(airquality$Ratio), col = "red", lwd = 2)
```


### ggplot2

```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
airquality %>% ggplot(aes(x = Day, y = Ratio)) +
  geom_point(show.legend = F, shape = 21, size = 3, alpha = 0.7, fill = "#225ea8") +
  scale_fill_viridis(option = "C", direction = 1) +
  geom_hline(yintercept = mean(airquality$Ratio), color = "red", size = 1.5) +
  labs(
    title = "Ratio versus day",
    x = "Day in month",
    y = "Ratio(Wind/Temp)"
  ) +
  theme_bw() + 
      theme(
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        axis.line = element_line(size =0.3),
        axis.text = element_text(size = 12, color = "black", hjust=1),
        axis.title = element_text(face = "bold", size = 12, color = "black"),
        plot.title = element_text(face = "bold", size = 14, color = "black", hjust = 0.5),
        legend.position = "top"
    )
```

# Question 10 {.tabset .tabset-fade .tabset-pills}

## Q10.1

**Draw 1000 samples of size 31 from B(1, 0.5)**

```{r}
mat_10_1 <- matrix(nrow = 31, ncol = 1000)

for (i in 1:1000) {
  mat_10_1[, i] <- rbinom(31, 1, 0.5)
}
```

## Q10.2

**Calculate the sample mean for each sample**
```{r}
mat_mean <- vector(length = 1000)
  
for (i in 1:1000) {
  mat_mean[i] <- mean(mat_10_1[, i])
}
```

## Q10.3
**Plot a histogram for the sample means**


```{r, fig.fullwidth = TRUE, fig.height = 5, fig.width = 9}
hist(mat_mean, xlab = "m.x", main = "histogram for the sample mean")
```











